if(window.CanNotify&&!window.messaging){var configNotify={apiKey:"AIzaSyDrAYaOGPTFRV0yOfEMo8z5-SDg8hwXIo8",authDomain:"bizweb-5c89e.firebaseapp.com",databaseURL:"https://bizweb-5c89e.firebaseio.com",storageBucket:"bizweb-5c89e.appspot.com",messagingSenderId:"315097405748"};firebase.initializeApp(configNotify);window.messaging=firebase.messaging();window.messaging.onTokenRefresh(function(){window.messaging.getToken().then(function(n){console.log("Token refreshed.");setTokenSentToServer(!1);sendTokenToServer(n)}).catch(function(n){console.log("Unable to retrieve refreshed token ",n)})});window.messaging.onMessage(function(n){var t,i;console.log("Message received. ",n);t=n.notification;t.click_action!=window.location.href&&(i=new Notification(t.title,{icon:"https://bizweb.dktcdn.net/assets/images/icon_bizweb_large.png",body:t.body,tag:"orderPlacedNotification"}),i.onclick=function(){window.open(t.click_action)})});function sendTokenToServer(n){isTokenSentToServer()?console.log("Token already sent to server so won't send it again unless it changes"):(console.log("Sending token to server..."),$.ajax({type:"POST",url:"/admin/notifications",data:{token:n},global:!1,success:function(){console.log(n);setTokenSentToServer(!0)}}))}function sendRemoveTokenToServer(n){console.log("Sending token to server...");$.ajax({type:"POST",url:"/admin/notifications/remove",data:{token:n},global:!1,success:function(){console.log(n);setTokenSentToServer(!1)}})}function isTokenSentToServer(){return!1}function setTokenSentToServer(n){n?window.localStorage.setItem("sentToServer",1):window.localStorage.setItem("sentToServer",0)}function requestPermission(){console.log("Requesting permission...");window.messaging.requestPermission().then(function(){console.log("Notification permission granted.");window.messaging.getToken().then(function(n){sendTokenToServer(n)}).catch(function(n){console.log("Error retrieving Instance ID token. ",n)})}).catch(function(n){console.log("Unable to get permission to notify.",n)})}function unsubscribe(){window.messaging.getToken().then(function(n){sendRemoveTokenToServer(n)}).catch(function(n){console.log("Error retrieving Instance ID token. ",n)})}function deleteToken(){window.messaging.getToken().then(function(n){window.messaging.deleteToken(n).then(function(){console.log("Token deleted.");setTokenSentToServer(!1)}).catch(function(n){console.log("Unable to delete token. ",n)})}).catch(function(n){console.log("Error retrieving Instance ID token. ",n)})}}
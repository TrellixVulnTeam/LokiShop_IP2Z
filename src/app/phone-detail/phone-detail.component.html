<section *ngIf="phone" class="breadcrumbs">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="breadcrumb" itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                        <li class="home">
                            <a itemprop="url" href="/" title="Trang chủ">
                                <span itemprop="title">Trang chủ</span>
                            </a>
                            <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
                        </li>


                        <li>
                            <a itemprop="url" href="/san-pham-noi-bat">
                                <span itemprop="title">Sản phẩm</span>
                            </a>
                            <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
                        </li>

                        <li>
                            <strong>
                                <span itemprop="title">{{phone.name}}</span>
                            </strong>
                            <li>


                    </ul>
                </div>
            </div>
        </div>
    </section>








    <section *ngIf="phone" class="product-template product" itemscope itemtype="http://schema.org/Product">
        <div class="container">
            <div class="row">
                <div class="details-product">
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-5 images-pro">
                        <div class="large-image">
                            <a href="/" class="large_image_url checkurl dp-flex" data-rel="prettyPhoto[product-gallery]">
                                <div style="height:380px;width:380px;" class="zoomWrapper">
                                    <div style="height:380px;width:380px;" class="zoomWrapper">
                                        <img id="zoom_01" class="img-responsive" src="{{phone.thumb}}"
                                            alt="{{phone.name}}" style="position: absolute; width: 380px; height: 380px;">
                                    </div>
                                </div>

                            </a>
                        </div>


                        <div class="imgthumb-prolist">
                            <ul class="phone-thumbs">
                                <li *ngFor="let img of phone.imageUrl">
                                    <img alt="{{phone.name}}" src="{{img}}" (click)="setImage(img)" />
                                </li>
                            </ul>
                        </div>

                    </div>

                    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4 details-pro">
                        <h1 class="title-head">{{phone.name}}</h1>











                        <div class="price-box price-loop-style" itemscope itemtype="http://schema.org/Offer">



                            <span class="special-price">
                                <span class="price" itemprop="price">{{phone.sale_price | number}}₫</span>
                                <meta itemprop="priceCurrency" content="VND">
                            </span>
                            <span *ngIf="phone.sale_price < phone.price" class="old-price">
                                <span class="price" itemprop="priceSpecification">
                                    {{phone.price | number}}₫
                                </span>
                                <meta itemprop="priceCurrency" content="VND">
                            </span>

                            <span class="availability in-stock" itemscope itemtype="http://schema.org/ItemAvailability">
                                
                                    <span *ngIf="phone.inStock < 1;else elseBlock" id="thenBlock" itemprop="supersededBy">
                                        Hết hàng


                                    </span>
                                    <ng-template #elseBlock>
                                    <span id="elseBlock" itemprop="supersededBy">

                                        Còn lại: {{phone.inStock}}

                                    </span>
                                </ng-template>
                            </span>
                        </div>


                        <label>
                            <strong>Tổng quan</strong>
                        </label>
                        <div class="product-summary product_description">
                            <div class="rte description">

                                {{phone.snippet}}

                            </div>
                        </div>


                        <div class="form-product">
                            <form enctype="multipart/form-data" id="add-to-cart-form" action="/cart/add" method="post" class="form-inline">
                                <div class="box-variant clearfix">
                                    <div class="selector-wrapper">
                                        <label>Màu sắc</label>
                                        <select  class="single-option-selector" data-option="option1" id="product-selectors-option-0" #selectedColor>
                                            <option *ngFor="let color of phone.colors" value="{{color}}">{{color}}</option>
                                        </select>
                                    </div>
                                    
                                </div>

                                <div class="form-group product_quantity ">
                                    <label class="form-control-label">Số lượng</label>
                                    <button [disabled]="phone.inStock < 1" onclick="var result = document.getElementById('qty'); var qty = result.value; if( !isNaN( qty ) &amp;&amp; qty > 1 ) result.value--;return false;"
                                        class="reduced btn btn-ipnb" type="button">-</button>
                                    <input [disabled]="phone.inStock < 1" type="text" class="form-control text-xs-center qty" title="Số lượng" value="1" maxlength="3" id="qty" #qty name="quantity"
                                        onkeyup="valid(this,'numbers')" onblur="valid(this,'numbers')">
                                    <button [disabled]="phone.inStock < 1" onclick="var result = document.getElementById('qty'); var qty = result.value; if( !isNaN( qty )) result.value++;return false;"
                                        class="increase btn btn-ipnb" type="button">+</button>
                                </div>

                                <!-- BUTTON ACTIONS -->
                                <input class="hidden" type="hidden" name="variantId" value="17441886" />
                                <div class="button_actions">



                                    <button [disabled]="phone.inStock < 1" (mouseover)="getCategory(phone.category_id)" (click)="addToCart(phone)" type="submit" class="btn btn-buy btn-transition btn-cart btn_buy add_to_cart" title="Thêm vào giỏ hàng">
                                        <span>
                                            <i class="fa fa-shopping-cart"></i> Thêm vào giỏ hàng</span>
                                    </button>



                                </div>
                                <!-- END BUTTON ACTIONS -->
                            </form>
                            <form [hidden]="phone.inStock > 0" class="form-inline" enctype="multipart/form-data" id="subscribe-email" action="/email/subscribe" method="post">
                                <input type="email" style="width: 250px" [disabled]="phone.inStock > 0" type="text" class="form-control text-xs-center qty" title="Nhận thư cập nhật sản phẩm"  maxlength="100" id="sub-email" name="sub-email"
                                        onkeyup="validEmail(this)" onblur="validEmail(this)" placeholder="Nhận thư cập nhật sản phẩm...">
                                <button [disabled]="phone.inStock > 0" (click)="addToCart(product)" type="submit" class="increase btn btn-ipnb" title="Đăng kí" style="width: 120px">
                                                <span>
                                                    <i class="fa fa-check"></i> Đăng kí</span>
                                            </button>
                            </form>
                        </div>




                    </div>

                    <div class="col-xs-12 hidden-sm col-md-3 col-lg-3">






                        <div class="product-banner product-banner-1 banner-item">
                            <a href="#" title="">
                                <figure>
                                    <img class="img-responsive" src="http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/product_banner_1_image.png?1522816147817"
                                        alt="LokiShop-2018">
                                </figure>
                            </a>
                        </div>







                        <div class="product-banner product-banner-2 banner-item">
                            <a href="#" title="">
                                <figure>
                                    <img class="img-responsive" src="http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/product_banner_2_image.png?1522816147817"
                                        alt="LokiShop-2018">
                                </figure>
                            </a>
                        </div>


                    </div>
                </div>
            </div>


        </div>
    </section>


    <script type="text/javascript">
        function valid(o, w) {
            o.value = o.value.replace(valid.r[w], '');
            var qtyCount = document.getElementById('qty').value;
            if (qtyCount == 0) {
                document.getElementById("qty").value = 1;
            }
        }
        valid.r = {
            'numbers': /[^\d]/g
        }
    </script>
    <script>
        
        function validateEmail(emailField){
        var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;

        if (reg.test(emailField.value) == false) 
        {
            alert('Địa chỉ email không hợp lệ!');
            return false;
        }

        return true;

}
    </script>
    <script>
        var ww = $(window).width();

        var selectCallback = function (variant, selector) {
            if (variant) {
                var form = jQuery('#' + selector.domIdPrefix).closest('form');
                for (var i = 0, length = variant.options.length; i < length; i++) {
                    var radioButton = form.find('.swatch[data-option-index="' + i + '"] :radio[value="' + variant.options[i] + '"]');
                    if (radioButton.size()) {
                        radioButton.get(0).checked = true;
                    }
                }
            }

            var addToCart = jQuery('.details-pro .button_actions .btn-cart'),
                priceBox = jQuery('.details-pro .price-box'),
                productPrice = jQuery('.details-pro .special-price .price'),
                comparePrice = jQuery('.details-pro .old-price .price'),
                inputQty = jQuery('.details-pro .product_quantity'),
                btnBox = jQuery('.details-pro .button_actions'),
                stock = jQuery('.details-pro .availability');

            if (variant) {
                addToCart.removeAttr('disabled');
                if (variant.inventory_quantity == 0) {
                    if (variant.inventory_management == "bizweb") {
                        inputQty.hide();
                        btnBox.show();
                        addToCart.removeClass('btn_buy').addClass('btn_soldout').attr('disabled', 'disabled').html('<span><i class="fa fa-ban"></i> Hết hàng</span>').show();
                        stock.addClass('out-of-stock').removeClass('in-stock').html('<span>Hết hàng</span>');
                        if (variant.price != 0) {
                            priceBox.show();
                            productPrice.html(Bizweb.formatMoney(variant.price, "{{amount_no_decimals_with_comma_separator}}₫")).show();
                            if (variant.compare_at_price > variant.price) {
                                comparePrice.html(Bizweb.formatMoney(variant.compare_at_price, "{{amount_no_decimals_with_comma_separator}}₫")).show();
                            } else {
                                comparePrice.hide();
                            }
                        } else {
                            stock.removeClass('out-of-stock').addClass('in-stock').html('<span>Liên hệ</span>');
                            productPrice.html('Liên hệ');
                            comparePrice.hide();
                        }
                    } else {
                        inputQty.show();
                        btnBox.show();
                        stock.removeClass('out-of-stock').addClass('in-stock').html('<span>Còn hàng</span>');
                        addToCart.removeClass('btn_soldout').addClass('btn_buy').removeAttr('disabled', 'disabled').html('<span><i class="fa fa-shopping-cart"></i> Thêm vào giỏ hàng</span>').show();
                        if (variant.price != 0) {
                            if (variant.compare_at_price > variant.price) {
                                comparePrice.html(Bizweb.formatMoney(variant.compare_at_price, "{{amount_no_decimals_with_comma_separator}}₫")).show();
                            } else {
                                comparePrice.hide();
                            }
                        } else {
                            productPrice.html('Liên hệ');
                            comparePrice.hide();
                            inputQty.hide();
                            btnBox.hide();
                        }
                    }
                } else {
                    priceBox.show();
                    inputQty.show();
                    btnBox.show();
                    if (variant.price == 0) {
                        stock.removeClass('out-of-stock').addClass('in-stock').html('<span>Liên hệ</span>');
                        inputQty.hide();
                        productPrice.html('Liên hệ');
                        addToCart.hide();
                        comparePrice.hide();
                    } else {
                        stock.removeClass('out-of-stock').addClass('in-stock').html('<span>Còn hàng</span>');
                        inputQty.show();
                        inputQty.removeClass('hidden');
                        productPrice.html(Bizweb.formatMoney(variant.price, "{{amount_no_decimals_with_comma_separator}}₫")).show();
                        if (variant.compare_at_price > variant.price) {
                            comparePrice.html(Bizweb.formatMoney(variant.compare_at_price, "{{amount_no_decimals_with_comma_separator}}₫")).show();
                        } else {
                            comparePrice.hide();
                            btnBox.show();
                            addToCart.show();
                        }
                        addToCart.removeClass('btn_soldout').addClass('btn_buy').removeAttr('disabled', 'disabled').html('<span><i class="fa fa-shopping-cart"></i> Thêm vào giỏ hàng</span>').show();
                    }
                }
            } else {
                stock.addClass('out-of-stock').removeClass('in-stock').html('<span>Hết hàng</span>');
                productPrice.html('Liên hệ');
                comparePrice.hide();
                inputQty.hide();
                addToCart.addClass('btn_soldout').attr('disabled', 'disabled').html('<span><i class="fa fa-ban"></i> Hết hàng</span>');      // set add-to-cart button to unavailable class and disable button
            }


            /*begin variant image*/
            if (variant && variant.image) {
                var originalImage = jQuery(".large-image img");
                var newImage = variant.image;
                var element = originalImage[0];
                Bizweb.Image.switchImage(newImage, element, function (newImageSizedSrc, newImage, element) {
                    jQuery(element).parents('a').attr('href', newImageSizedSrc);
                    jQuery(element).attr('src', newImageSizedSrc);
                });

                if (ww >= 1200) {

                    setTimeout(function () {
                        $('.checkurl').attr('href', $(this).attr('src'));
                        $('.zoomContainer').remove();
                        $('#zoom_01').elevateZoom({
                            gallery: 'gallery_01',
                            zoomWindowOffetx: 10,
                            easing: true,
                            scrollZoom: true,
                            cursor: 'pointer',
                            galleryActiveClass: 'active',
                            imageCrossfade: true
                        });
                    }, 300);

                }
            }


            /*end of variant image*/

            if ($('.selector-wrapper')[0].childElementCount == 1) {
                $('.selector-wrapper').prepend('<label>Title</label>');
            }

        };

        // initialize multi selector for product



        jQuery('.selector-wrapper').addClass('clearfix');

        jQuery('.selector-wrapper').prepend("<label for='product-select-option-0'>Title</label>");


        $('.selector-wrapper').hide();


        jQuery('.swatch :radio').change(function () {
            var optionIndex = jQuery(this).closest('.swatch').attr('data-option-index');
            var optionValue = jQuery(this).val();
            jQuery(this)
                .closest('form')
                .find('.single-option-selector')
                .eq(optionIndex)
                .val(optionValue)
                .trigger('change');
        });
    </script>
    <script>
        if (ww >= 1200) {

            $(document).ready(function () {
                $('#zoom_01').elevateZoom({
                    gallery: 'gallery_01',
                    zoomWindowOffetx: 10,
                    easing: true,
                    scrollZoom: true,
                    cursor: 'pointer',
                    galleryActiveClass: 'active',
                    imageCrossfade: true
                });
            });

        }
        // $('#gallery_01 img, .swatch-element label').click(function(e){
        $('#gallery_01 img').click(function (e) {
            var current_click = $(this).attr('src');
            current_click = current_click.replace("/thumb/small", "");
            $('.large-image img').attr('src', current_click);
            $('.large-image a').attr('href', current_click);
            if (ww >= 1200) {

                setTimeout(function () {
                    $('.checkurl').attr('href', $(this).attr('src'));
                    $('.zoomContainer').remove();
                    $('#zoom_01').elevateZoom({
                        gallery: 'gallery_01',
                        zoomWindowOffetx: 10,
                        easing: true,
                        scrollZoom: true,
                        cursor: 'pointer',
                        galleryActiveClass: 'active',
                        imageCrossfade: true
                    });
                }, 300);

            }
        });
    </script>

    <!-- Bizweb javascript -->
    <script src='http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/option-selectors.js?1522816147817' type='text/javascript'></script>
    <script src='http://bizweb.dktcdn.net/assets/themes_support/api.jquery.js?4' type='text/javascript'></script>

    <!-- Plugin JS -->
    <script src='http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/owl.carousel.min.js?1522816147817' type='text/javascript'></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>

    <!-- Add to cart -->
    <div class="ajax-load">
        <span class="loading-icon">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px"
                height="30px" viewBox="0 0 24 30" style="enable-background:new 0 0 50 50;" xml:space="preserve">
                <rect x="0" y="10" width="4" height="10" fill="#333" opacity="0.2">
                    <animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0s" dur="0.6s" repeatCount="indefinite" />
                    <animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0s" dur="0.6s" repeatCount="indefinite" />
                    <animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0s" dur="0.6s" repeatCount="indefinite" />
                </rect>
                <rect x="8" y="10" width="4" height="10" fill="#333" opacity="0.2">
                    <animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0.15s" dur="0.6s" repeatCount="indefinite"
                    />
                    <animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0.15s" dur="0.6s" repeatCount="indefinite"
                    />
                    <animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0.15s" dur="0.6s" repeatCount="indefinite" />
                </rect>
                <rect x="16" y="10" width="4" height="10" fill="#333" opacity="0.2">
                    <animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0.3s" dur="0.6s" repeatCount="indefinite"
                    />
                    <animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0.3s" dur="0.6s" repeatCount="indefinite"
                    />
                    <animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0.3s" dur="0.6s" repeatCount="indefinite" />
                </rect>
            </svg>
        </span>
    </div>

    <div class="loading awe-popup">
        <div class="overlay"></div>
        <div class="loader" title="2">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px"
                height="30px" viewBox="0 0 24 30" style="enable-background:new 0 0 50 50;" xml:space="preserve">
                <rect x="0" y="10" width="4" height="10" fill="#333" opacity="0.2">
                    <animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0s" dur="0.6s" repeatCount="indefinite" />
                    <animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0s" dur="0.6s" repeatCount="indefinite" />
                    <animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0s" dur="0.6s" repeatCount="indefinite" />
                </rect>
                <rect x="8" y="10" width="4" height="10" fill="#333" opacity="0.2">
                    <animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0.15s" dur="0.6s" repeatCount="indefinite"
                    />
                    <animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0.15s" dur="0.6s" repeatCount="indefinite"
                    />
                    <animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0.15s" dur="0.6s" repeatCount="indefinite" />
                </rect>
                <rect x="16" y="10" width="4" height="10" fill="#333" opacity="0.2">
                    <animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0.3s" dur="0.6s" repeatCount="indefinite"
                    />
                    <animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0.3s" dur="0.6s" repeatCount="indefinite"
                    />
                    <animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0.3s" dur="0.6s" repeatCount="indefinite" />
                </rect>
            </svg>
        </div>

    </div>

    <div class="addcart-popup product-popup awe-popup">
        <div class="overlay no-background"></div>
        <div class="content">
            <div class="row row-noGutter">
                <div class="col-xl-6 col-xs-12">
                    <div class="btn btn-full btn-primary a-left popup-title">
                        <i class="fa fa-check"></i>Thêm vào giỏ hàng thành công
                    </div>
                    <a href="javascript:void(0)" class="close-window close-popup">
                        <i class="fa fa-close"></i>
                    </a>
                    <div class="info clearfix">
                        <div class="product-image margin-top-5">
                            <img alt="popup" src="http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/logo.png?1522816147817" style="max-width:150px; height:auto"
                            />
                        </div>
                        <div class="product-info">
                            <p class="product-name"></p>
                            <p class="quantity color-main">
                                <span>Số lượng: </span>
                            </p>
                            <p class="total-money color-main">
                                <span>Tổng tiền: </span>
                            </p>

                        </div>
                        <div class="actions">
                            <button class="btn  btn-primary  margin-top-5 btn-continue">Tiếp tục mua hàng</button>
                            <button class="btn btn-gray margin-top-5" onclick="window.location='/cart'">Kiểm tra giỏ hàng</button>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
    <div class="error-popup awe-popup">
        <div class="overlay no-background"></div>
        <div class="popup-inner content">
            <div class="error-message"></div>
        </div>
    </div>
    <script>
        Bizweb.updateCartFromForm = function (cart, cart_summary_id, cart_count_id) {
            if ((typeof cart_summary_id) === 'string') {
                var cart_summary = jQuery(cart_summary_id);
                if (cart_summary.length) {
                    // Start from scratch.
                    cart_summary.empty();
                    // Pull it all out.        
                    jQuery.each(cart, function (key, value) {
                        if (key === 'items') {

                            var table = jQuery(cart_summary_id);
                            if (value.length) {
                                jQuery('<ul class="list-item-cart"></ul>').appendTo(table);
                                jQuery.each(value, function (i, item) {

                                    var src = Bizweb.resizeImage(item.image, 'small');
                                    if (src == null) {
                                        src = "http://bizweb.dktcdn.net/thumb/small/100/305/798/themes/650335/assets/no-image.png?1522816147817";
                                    }

                                    var buttonQty = "";
                                    if (item.quantity == '1') {
                                        buttonQty = 'disabled';
                                    } else {
                                        buttonQty = '';
                                    }
                                    if (item.variant_title == 'Default Title') {
                                        var item_variant_title = "";
                                    } else {
                                        var item_variant_title = '<p class="hover-cart-variant-title"><span>' + item.variant_title + '</span></p>';
                                    }
                                    jQuery('<li class="item productid-' + item.variant_id + '">'
                                        + '<a class="product-image" href="' + item.url + '" title="' + item.name + '">'
                                        + '<img alt="' + item.name + '" src="' + src + '"\>'
                                        + '</a>'
                                        + '<div class="detail-item">'
                                        + '<div class="product-details">'
                                        + '<a href="javascript:;" data-id="' + item.variant_id + '" title="Xóa" class="remove-item-cart fa fa-times-circle">&nbsp;</a>'
                                        + '<p class="product-name text3line">'
                                        + '<a href="' + item.url + '" title="' + item.name + '">' + item.title + '</a>'
                                        + '</p>'
                                        + item_variant_title
                                        + '</div>'
                                        + '<div class="product-details-bottom">'
                                        + '<span class="price">'
                                        + Bizweb.formatMoney(item.price, "{{amount_no_decimals_with_comma_separator}}₫")
                                        + '</span>'
                                        + '<div class="quantity-select">'
                                        + '<input class="variantID" type="hidden" name="variantId" value="' + item.variant_id + '">'
                                        + '<input type="text" maxlength="12" min="0" class="input-text number-sidebar qty' + item.variant_id + '" id="qty' + item.variant_id + '" name="Lines" id="updates_' + item.variant_id + '" size="4" value="' + item.quantity + '">'
                                        + '</div>'
                                        + '</div>'
                                        + '</div>'
                                        + '</li>').appendTo(table.children('.list-item-cart'));
                                });
                                jQuery('<div class="top-subtotal">Thành tiền: <span class="price">' + Bizweb.formatMoney(cart.total_price, "{{amount_no_decimals_with_comma_separator}}₫") + '</span></div>').appendTo(table);
                                jQuery('<div class="actions">'
                                    + '<a href="/cart" class="btn btn-style btn-transition btn-to-cart" title="Tới giỏ hàng">'
                                    + '<span><i class="fa fa-shopping-cart"></i> Giỏ hàng</span>'
                                    + '</a>'
                                    + '<a href="/checkout" class="btn btn-style btn-transition btn-checkout" title="Tiến hành thành toán">'
                                    + '<span><i class="fa fa-check"></i> Thanh toán</span>'
                                    + '</a>'
                                    + '</div>').appendTo(table);
                            }
                            else {
                                jQuery('<div class="no-item"><p>Không có sản phẩm nào trong giỏ hàng.</p></div>').appendTo(table);

                            }
                        }
                    });
                }
            }
            updateCartDesc(cart);
            var numInput = document.querySelector('#cart-sidebar input.input-text');
            if (numInput != null) {
                // Listen for input event on numInput.
                numInput.addEventListener('input', function () {
                    // Let's match only digits.
                    var num = this.value.match(/^\d+$/);
                    if (num == 0) {
                        // If we have no match, value will be empty.
                        this.value = 1;
                    }
                    if (num === null) {
                        // If we have no match, value will be empty.
                        this.value = "";
                    }
                }, false)
            }
        }

        Bizweb.updateCartPageForm = function (cart, cart_summary_id, cart_count_id) {
            if ((typeof cart_summary_id) === 'string') {
                var cart_summary = jQuery(cart_summary_id);
                if (cart_summary.length) {
                    // Start from scratch.
                    cart_summary.empty();
                    // Pull it all out.        
                    jQuery.each(cart, function (key, value) {
                        if (key === 'items') {
                            var table = jQuery(cart_summary_id);
                            if (value.length) {
                                var pageCart = '<div class="cart page_cart cart_des_page hidden-xs-down">'
                                    + '<div class="col-lg-12">'
                                    + '<div class="form-cart">'
                                    + '<form action="/cart" method="post">'
                                    + '<div class="table-cart">'
                                    + '<table class="table">'
                                    + '<thead>'
                                    + '<tr style="background: #f23534; color: #fff;">'
                                    + '<th style="width:65px;">Xóa</th>'
                                    + '<th style="width:190px;">Ảnh sản phẩm</th>'
                                    + '<th style="min-width:150px;">Tên sản phẩm</th>'
                                    + '<th style="width:150px; text-align:center">Giá</th>'
                                    + '<th style="width:110px;">Số lượng</th>'
                                    + '<th style="width:140px;">Thành tiền</th>'
                                    + '</tr>'
                                    + '</thead>'
                                    + '<tbody>'
                                    + '</tbody>'
                                    + '</table>'
                                    + '</div>'
                                    + '</form>'
                                    + '</div>'
                                    + '</div>';
                                var pageCartCheckout = '<div class="col-lg-5">'
                                    + '<div class="form-cart-button mtb">'
                                    + '<div class="">'
                                    + '<a href="/collections/all" class="form-cart-continue">Tiếp tục mua hàng</a>'
                                    + '</div>'
                                    + '</div>'
                                    + '</div>'
                                    + '<div class="col-lg-5 col-lg-offset-2 bg_cart">'
                                    + '<div class="table-total">'
                                    + '<table class="table ">'
                                    + '<tr>'
                                    + '<td>Tổng giá sản phẩm</td>'
                                    + '<td class="txt-right totals_price">' + Bizweb.formatMoney(cart.total_price, "{{amount_no_decimals_with_comma_separator}}₫") + '</td>'
                                    + '</tr>'
                                    + '<tr>'
                                    + '<td>Tiền vận chuyển</td>'
                                    + '<td class="txt-right">Tính khi thanh toán</td>'
                                    + '</tr>'
                                    + '<tr>'
                                    + '<td>TỔNG TIỀN THANH TOÁN</td>'
                                    + '<td class="txt-right totals_price">' + Bizweb.formatMoney(cart.total_price, "{{amount_no_decimals_with_comma_separator}}₫") + '</td>'
                                    + '</tr>'
                                    + '</table>'
                                    + '</div>'
                                    + '<a onclick="window.location.href=\'/checkout\'" class="btn-checkout-cart">Thanh toán ngay</a>'
                                    + '</div>';
                                jQuery(pageCart).appendTo(table);
                                jQuery.each(value, function (i, item) {
                                    var buttonQty = "";
                                    if (item.quantity == '1') {
                                        buttonQty = 'disabled';
                                    } else {
                                        buttonQty = '';
                                    }
                                    var link_img1 = Bizweb.resizeImage(item.image, 'compact');
                                    if (link_img1 == "null" || link_img1 == '' || link_img1 == null) {
                                        link_img1 = "http://bizweb.dktcdn.net/thumb/compact/100/305/798/themes/650335/assets/no-image.png?1522816147817";
                                    }
                                    var pageCartItem = '<tr class="productid-' + item.variant_id + '">'
                                        + '<td>'
                                        + '<a class="button remove-item remove-item-cart" title="Xóa" href="javascript:;" data-id="' + item.variant_id + '"><i class="fa fa-times" aria-hidden="true"></i></a>'
                                        + '</td>'
                                        + '<td class="cartImg">'
                                        + '<a href="' + item.url + '" title="' + item.name + '">'
                                        + '<img alt="' + item.name + item.variant_title + '" src="' + link_img1 + '" alt="' + item.name + '">'
                                        + '</a>'
                                        + '</td>'
                                        + '<td class="title_cart">'
                                        + '<a href="' + item.url + '" title="' + item.name + '">' + item.title + '</a><br><span class="variant-title">' + item.variant_title + '</span>'
                                        + '</td>'
                                        + '<td class="price_cart tRight">' + Bizweb.formatMoney(item.price, "{{amount_no_decimals_with_comma_separator}}₫")
                                        + '</td>'
                                        + '<td class="input_qty_pr cart-quantity tRight">'
                                        + '<input class="variantID" type="hidden" name="variantId" value="' + item.variant_id + '">'
                                        + '<button onClick="var result = document.getElementById(\'qtyItemc' + item.variant_id + '\'); var qtyItemc' + item.variant_id + ' = result.value; if( !isNaN( qtyItemc' + item.variant_id + ' )) result.value++;return false;" class="increase_pop items-count btn-plus" type="button"><i class="fa fa-caret-up" aria-hidden="true"></i></button><button onClick="var result = document.getElementById(\'qtyItemc' + item.variant_id + '\'); var qtyItemc' + item.variant_id + ' = result.value; if( !isNaN( qtyItemc' + item.variant_id + ' ) &amp;&amp; qtyItemc' + item.variant_id + ' &gt; 1 ) result.value--;return false;" ' + buttonQty + ' class="reduced_pop items-count btn-minus" type="button"><i class="fa fa-caret-down" aria-hidden="true"></i></button>'
                                        + '<input type="text" maxlength="12" min="1" class="input-text number-sidebar input_pop input_pop qtyItemc' + item.variant_id + '" id="qtyItemc' + item.variant_id + '" name="Lines" id="updates_' + item.variant_id + '" size="4" value="' + item.quantity + '" disabled>'
                                        + '</td>'
                                        + '<td class="price_cart2 tRight">' + Bizweb.formatMoney(item.price * item.quantity, "{{amount_no_decimals_with_comma_separator}}₫")
                                        + '</td>'
                                        + '</tr>';

                                    jQuery(pageCartItem).appendTo(table.find('tbody'));
                                    if (item.variant_title == 'Default Title') {
                                        $('.variant-title').hide();
                                    }
                                });
                                jQuery(pageCartCheckout).appendTo(table.children('.page_cart'));
                            } else {
                                jQuery('<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">'
                                    + '<div class="style-form">'
                                    + '<p>Không có sản phẩm nào trong giỏ hàng</p>'
                                    + '<a href="/collections/all" class="form-cart-continue">Tiếp tục mua hàng</a>'
                                    + '</div>'
                                    + '</div>').appendTo(table);
                                jQuery('.bg-cart-page').css('min-height', 'auto');
                            }
                        }
                    });
                }
            }
            jQuery('.total-price').html(Bizweb.formatMoney(cart.total_price, "{{amount_no_decimals_with_comma_separator}}₫"));
            updateCartDesc(cart);
            jQuery('#wait').hide();
        }

        Bizweb.updateCartPageFormMobile = function (cart, cart_summary_id, cart_count_id) {
            if ((typeof cart_summary_id) === 'string') {
                var cart_summary = jQuery(cart_summary_id);
                if (cart_summary.length) {
                    // Start from scratch.
                    cart_summary.empty();
                    // Pull it all out.        
                    jQuery.each(cart, function (key, value) {
                        if (key === 'items') {
                            var table = jQuery(cart_summary_id);
                            if (value.length) {
                                var pageCart = '<div class="cart_mb cart_ct_mobile">'
                                    + '<div class="cart_mobile_content">'
                                    + '<form action="/cart" method="post" novalidate></form>'
                                    + '<div class="body-item"></div>'
                                    + '</div>'
                                    + '</div>';
                                var pageCartCheckout = '<div class="row">'
                                    + '<div class="col-lg-5">'
                                    + '<div class="form-cart-button mta">'
                                    + '<div class="">'
                                    + '<a href="/collections/all" class="form-cart-continue">Tiếp tục mua hàng</a>'
                                    + '</div>'
                                    + '</div>'
                                    + '</div>'
                                    + '<div class="col-lg-5 col-lg-offset-2 bg_cart">'
                                    + '<div class="table-total">'
                                    + '<table class="table ">'
                                    + '<tr>'
                                    + '<td>Tổng giá sản phẩm</td>'
                                    + '<td class="txt-right totals_price">' + Bizweb.formatMoney(cart.total_price, "{{amount_no_decimals_with_comma_separator}}₫") + '</td>'
                                    + '</tr>'
                                    + '<tr>'
                                    + '<td>Tiền vận chuyển</td>'
                                    + '<td class="txt-right">Tính khi thanh toán</td>'
                                    + '</tr>'
                                    + '<tr>'
                                    + '<td>TỔNG TIỀN THANH TOÁN</td>'
                                    + '<td class="txt-right totals_price">' + Bizweb.formatMoney(cart.total_price, "{{amount_no_decimals_with_comma_separator}}₫") + '</td>'
                                    + '</tr>'
                                    + '</table>'
                                    + '</div>'
                                    + '<a onclick="window.location.href=\'/checkout\'" class="btn-checkout-cart">Thanh toán ngay</a>'
                                    + '</div>'
                                    + '</div>';
                                jQuery(pageCart).appendTo(table);
                                jQuery.each(value, function (i, item) {
                                    var buttonQty = "";
                                    if (item.quantity == '1') {
                                        buttonQty = 'disabled';
                                    } else {
                                        buttonQty = '';
                                    }
                                    var link_img2 = Bizweb.resizeImage(item.image, 'compact');
                                    if (link_img2 == "null" || link_img2 == '' || link_img2 == null) {
                                        link_img2 = "http://bizweb.dktcdn.net/thumb/compact/100/305/798/themes/650335/assets/no-image.png?1522816147817";
                                    }
                                    var ww = $(window).width();
                                    var itemname = item.name;
                                    if (ww >= 480) {
                                        if (itemname.length > 100) {
                                            itemname = item.name.slice(0, 100) + '...';
                                        }
                                    } else if (ww >= 375 && ww < 480) {
                                        if (itemname.length > 70) {
                                            itemname = item.name.slice(0, 70) + '...';
                                        }
                                    } else {
                                        if (itemname.length > 40) {
                                            itemname = item.name.slice(0, 40) + '...';
                                        }
                                    }

                                    $(window).on('resize', function () {
                                        if (ww >= 480) {
                                            if (itemname.length > 100) {
                                                itemname = item.name.slice(0, 100) + '...';
                                            }
                                        } else if (ww >= 375 && ww < 480) {
                                            if (itemname.length > 70) {
                                                itemname = item.name.slice(0, 70) + '...';
                                            }
                                        } else {
                                            if (itemname.length > 40) {
                                                itemname = item.name.slice(0, 40) + '...';
                                            }
                                        }
                                    });

                                    var pageCartItem = '<div class="item_cart productid-' + item.variant_id + '">'
                                        + '<div class="image_cart_mobile">'
                                        + '<a title="' + item.name + '" href="' + item.url + '">'
                                        + '<img alt="' + item.name + '" src="' + link_img2 + '">'
                                        + '</a>'
                                        + '</div>'
                                        + '<div class="name_item_cart">'
                                        + '<h3>'
                                        + '<a href="' + item.url + '" title="' + item.name + '">' + itemname + '</a>'
                                        + '</h3>'
                                        + '<span class="variant-title">' + item.variant_title + '</span>'
                                        + '<span class="item-price">Giá : '
                                        + '<span class="price">' + Bizweb.formatMoney(item.price, "{{amount_no_decimals_with_comma_separator}}₫") + '</span>'
                                        + '</span>'
                                        + '</div>'
                                        + '<div class="slg_cart">'
                                        + '<div class="qty_mb">'
                                        + '<input class="variantID" type="hidden" name="variantId" value="' + item.variant_id + '">'
                                        + '<input type="text" maxlength="12" min="0" class="input-text number-sidebar qtymb' + item.variant_id + '" id="qtymb' + item.variant_id + '" name="Lines" id="updates_' + item.variant_id + '" size="4" value="' + item.quantity + '">'
                                        + '<a class="remove-item-cart" href="javascript:;" data-id="' + item.variant_id + '" title="Xoá" style="display:block;margin:5px 0px 5px 10px; color:#111;">'
                                        + '<i class="fa fa-times" aria-hidden="true"></i>'
                                        + '</a>'
                                        + '<button onClick="var result = document.getElementById(\'qtymb' + item.variant_id + '\'); var qtymb' + item.variant_id + ' = result.value; if( !isNaN( qtymb' + item.variant_id + ' )) result.value++;return false;" class="btn_increase increase items-count btn-plus" type="button">'
                                        + '<i class="button_item fa fa-caret-up" aria-hidden="true"></i>'
                                        + '</button>'
                                        + '<button onClick="var result = document.getElementById(\'qtymb' + item.variant_id + '\'); var qtymb' + item.variant_id + ' = result.value; if( !isNaN( qtymb' + item.variant_id + ' ) &amp;&amp; qtymb' + item.variant_id + ' &gt; 1 ) result.value--;return false;" class="btn_reduced reduced items-count btn-minus" ' + buttonQty + ' type="button">'
                                        + '<i class="button_item fa fa-caret-down" aria-hidden="true"></i>'
                                        + '</button>'
                                        + '</div>'
                                        + '</div>'
                                        + '</div>';
                                    jQuery(pageCartItem).appendTo(table.find('.body-item'));
                                    if (item.variant_title == 'Default Title') {
                                        $('.variant-title').hide();
                                    }
                                });
                                jQuery(pageCartCheckout).appendTo(table.children('.cart_mb'));
                            }
                        }
                    });
                }
            }
            updateCartDesc(cart);
            jQuery('#wait').hide();
        }

        Bizweb.updateCartPopupForm = function (cart, cart_summary_id, cart_count_id) {
            if ((typeof cart_summary_id) === 'string') {
                var cart_summary = jQuery(cart_summary_id);
                if (cart_summary.length) {
                    // Start from scratch.
                    cart_summary.empty();
                    // Pull it all out.        
                    jQuery.each(cart, function (key, value) {
                        if (key === 'items') {
                            var table = jQuery(cart_summary_id);
                            if (value.length) {
                                jQuery.each(value, function (i, item) {
                                    var src = Bizweb.resizeImage(item.image, 'small');
                                    if (src == null) {
                                        src = "http://bizweb.dktcdn.net/thumb/small/100/305/798/themes/650335/assets/no-image.png?1522816147817";
                                    }
                                    var buttonQty = "";
                                    if (item.quantity == '1') {
                                        buttonQty = 'disabled';
                                    } else {
                                        buttonQty = '';
                                    }
                                    var pageCartItem = '<div class="item-popup productid-' + item.variant_id + '">'
                                        + '<div style="width: 80%;" class="text-left">'
                                        + '<div class="item-image">'
                                        + '<a class="product-image" href="' + item.url + '" title="' + item.name + '">'
                                        + '<img alt="' + item.name + '" src="' + src + '"\>'
                                        + '</a>'
                                        + '<p class="item-remove">'
                                        + '<a href="javascript:;" class="remove-item-cart" title="Xóa" data-id="' + item.variant_id + '">'
                                        + '<i class="fa fa-times-circle"></i> Xóa'
                                        + '</a>'
                                        + '</p>'
                                        + '</div>'
                                        + '<div class="item-info">'
                                        + '<p class="item-name">'
                                        + '<a href="' + item.url + '" title="' + item.name + '">'
                                        + item.title
                                        + '</a>'
                                        + '</p>'
                                        + '<p class="variant-tit">'
                                        + item.variant_title
                                        + '</p>'
                                        + '</div>'
                                        + '</div>'
                                        + '<div style="width: 20%;" class="text-right">'
                                        + '<div class="item-price">'
                                        + '<span class="price">' + Bizweb.formatMoney(item.price, "{{amount_no_decimals_with_comma_separator}}₫") + '</span>'
                                        + '</div>'
                                        + '<div class="fixab">'
                                        + '<input class="variantID" type="hidden" name="variantId" value="' + item.variant_id + '">'
                                        + '<input type="text" maxlength="12" min="0" class="input-text number-sidebar qtyItem' + item.variant_id + '" id="qtyItem' + item.variant_id + '" name="Lines" id="updates_' + item.variant_id + '" size="4" value="' + item.quantity + '" disabled>'
                                        + '</div>'
                                        + '</div>';
                                    jQuery(pageCartItem).appendTo(table);
                                    var itemvariant = $('.productid-' + item.variant_id + ' .variant-tit').text();
                                    if (itemvariant == 'Default Title') {
                                        $('.productid-' + item.variant_id + ' .variant-tit').hide();
                                    }
                                    $('.link_product').text();
                                });
                            }
                        }
                    });
                }
            }
            jQuery('.total-price').html(Bizweb.formatMoney(cart.total_price, "{{amount_no_decimals_with_comma_separator}}₫"));
            updateCartDesc(cart);
        }


        function updateCartDesc(data) {
            var $cartPrice = Bizweb.formatMoney(data.total_price, "{{amount_no_decimals_with_comma_separator}}₫"),
                $cartMobile = $('#header .cart-mobile .quantity-product'),
                $cartDesktop = $('.count_item_pr'),
                $cartDesktopList = $('.cart-counter-list'),
                $cartPopup = $('.cart-popup-count');
            $cartCountMobile = $('.cart-count-mobile');

            switch (data.item_count) {
                case 0:
                    $cartMobile.text('0');
                    $cartDesktop.text('0');
                    $cartDesktopList.text('0');
                    $cartPopup.text('0');
                    $cartCountMobile.text('0');

                    break;
                case 1:
                    $cartMobile.text('1');
                    $cartDesktop.text('1');
                    $cartDesktopList.text('1');
                    $cartPopup.text('1');
                    $cartCountMobile.text('1');

                    break;
                default:
                    $cartMobile.text(data.item_count);
                    $cartDesktop.text(data.item_count);
                    $cartDesktopList.text(data.item_count);
                    $cartPopup.text(data.item_count);
                    $cartCountMobile.text(data.item_count);

                    break;
            }
            $('.top-cart-content .top-subtotal .price, aside.sidebar .block-cart .subtotal .price, .popup-total .total-price').html($cartPrice);
            $('.popup-total .total-price').html($cartPrice);
            $('.shopping-cart-table-total .totals_price').html($cartPrice);
            $('.header-cart-price .totals_price_mobile').html($cartPrice);
            $('.cartCount').html(data.item_count);
            $('.table-total .totals_price').html($cartPrice);
            $('.header-cart-price .totals_price_mobile').html($cartPrice);
        }

        Bizweb.onCartUpdate = function (cart) {
            Bizweb.updateCartFromForm(cart, '.mini-products-list');
            Bizweb.updateCartPopupForm(cart, '#popup-cart-desktop .tbody-popup');

        };
        Bizweb.onCartUpdateClick = function (cart, variantId) {
            jQuery.each(cart, function (key, value) {
                if (key === 'items') {
                    jQuery.each(value, function (i, item) {
                        if (item.variant_id == variantId) {
                            $('.productid-' + variantId).find('.price_cart2').html(Bizweb.formatMoney(item.price * item.quantity, "{{amount_no_decimals_with_comma_separator}}₫"));
                            $('.productid-' + variantId).find('.items-count').prop("disabled", false);
                            $('.productid-' + variantId).find('.number-sidebar').prop("disabled", false);
                            $('.productid-' + variantId + ' .number-sidebar').val(item.quantity);
                            if (item.quantity == '1') {
                                $('.productid-' + variantId).find('.items-count.btn-minus').prop("disabled", true);
                            }
                        }
                    });
                }
            });
            updateCartDesc(cart);
        }

        Bizweb.onCartRemoveClick = function (cart, variantId) {
            jQuery.each(cart, function (key, value) {
                if (key === 'items') {
                    jQuery.each(value, function (i, item) {
                        if (item.variant_id == variantId) {
                            $('.productid-' + variantId).remove();
                        }
                    });
                }
            });
            updateCartDesc(cart);
        }
        $(window).ready(function () {
            $.ajax({
                type: 'GET',
                url: '/cart.js',
                async: false,
                cache: false,
                dataType: 'json',
                success: function (cart) {
                    Bizweb.updateCartFromForm(cart, '.mini-products-list');
                    Bizweb.updateCartPopupForm(cart, '#popup-cart-desktop .tbody-popup');

                }
            });
        });

    </script>
    <link href='http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/popup-cart.scss.css?1522816147817' rel='stylesheet'
        type='text/css' />

    <div id="popup-cart" class="modal fade" role="dialog">
        <div id="popup-cart-desktop" class="clearfix">
            <div class="title-popup-cart">
                <span class="pop-title">
                    <i class="fa fa-check check" aria-hidden="true"></i> Sản phẩm
                    <span class="cart-popup-name"></span> đã thêm vào giỏ hàng</span>
                <div class="content-popup-cart">
                    <div class="tbody-popup">
                    </div>
                    <div class="tfoot-popup">
                        <div class="tfoot-popup-1 clearfix">
                            <div class="pull-left popup-ship">
                            </div>
                            <div class="pull-right popup-total">
                                <p>Tổng tiền:
                                    <span class="total-price"></span>
                                </p>
                            </div>
                            <a href="/collections/all" class="button btn-continue" title="Tiếp tục mua hàng">
                                <span>
                                    <i class="fa fa-caret-left" aria-hidden="true"></i> Tiếp tục mua hàng</span>
                            </a>
                        </div>
                        <div class="tfoot-popup-2 clearfix">
                            <a class="button btn-proceed-checkout" title="Tiến hành đặt hàng" href="/checkout">
                                <span>Tiến hành đặt hàng</span>
                            </a>
                        </div>
                    </div>
                </div>
                <a title="Close" class="quickview-close close-window" href="javascript:;" onclick="$('#popup-cart').modal('hide');">
                    <i class="fa  fa-close"></i>
                </a>
            </div>
        </div>

    </div>
    <div id="myModal" class="modal fade" role="dialog">
    </div>
    <script src='http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/cs.script.js?1522816147817' type='text/javascript'></script>


    <!-- Main JS -->
    <script src='http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/main.js?1522816147817' type='text/javascript'></script>
    <script src='http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/update_scripts.js?1522816147817' type='text/javascript'></script>

    <!-- Product detail JS,CSS -->

    <script src='http://bizweb.dktcdn.net/100/305/798/themes/650335/assets/jquery.elevatezoom308.min.js?1522816147817' type='text/javascript'></script>
    <div class="zoomContainer" style="-webkit-transform: translateZ(0);position:absolute;left:260.25px;top:174px;height:380px;width:380px;">
        <div class="zoomLens" style="background-position: 0px 0px; float: right; overflow: hidden; z-index: 999; transform: translateZ(0px); opacity: 0.4; zoom: 1; width: 253.333px; height: 253.333px; background-color: white; cursor: pointer; border: 1px solid rgb(0, 0, 0); background-repeat: no-repeat; position: absolute; left: 0px; top: 127px; display: none;">&nbsp;</div>
        <div class="zoomWindowContainer" style="width: 400px;">
            <div style="overflow: hidden; background-position: 0px -208px; text-align: center; background-color: rgb(255, 255, 255); width: 400px; height: 400px; float: left; background-size: 600px 600px; z-index: 100; border: 4px solid rgb(136, 136, 136); background-repeat: no-repeat; position: absolute; background-image: url(&quot;//bizweb.dktcdn.net/thumb/grande/100/305/798/products/acer-e5-411-c5rz-01.jpg?v=1522816156700&quot;); top: 0px; left: 390px; display: none;"
                class="zoomWindow">&nbsp;</div>
        </div>
    </div>